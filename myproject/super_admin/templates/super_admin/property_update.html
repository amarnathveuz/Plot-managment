
{% extends "super_admin/base.html" %}

{% load static %}
{% block content %}

    <style>
        .form-control.mystyle{
        background-color: #8c95a126;
        
        
    }
    </style>

    <form action="" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
    <div class="container-fluid mt-4">
        <div class="row">
            <div class="col-12 px-0">
                <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                    <!-- <h4 class="mb-sm-0">Payroll</h4> -->

                    <div class="page-title-left">
                        <ol class="breadcrumb m-0">
                            <li class="breadcrumb-item"><a href="javascript: void(0);">Property Management</a>
                            </li>
                            <li class="breadcrumb-item active"><a href="javascript: void(0);">Edit</a></li>

                        </ol>
                        <div class="margn">
                            
                            <a onclick="Edit_function()" id="edit_id" style="padding: 5px 10px !important;color: white;" class="btn btn-prim pay">
                                Edit
                          
                            </a>
                            <style>
                                .display_name{
                                    display: none!important;
                                }
                            </style>
                            <a><button type="submit" id="update_id"  style="padding: 5px 10px !important" class="btn btn-prim pay display_name">
                                    Update
                                </button></a>
                            <a href="property_management"><button style="padding: 5px 10px !important;" type="button" class="btn btn-pri pay discard-payroll"> Discard
                                </button></a>

                                {% if history %}
                                <a href="property_booking_history?id={{data.id}}"><button style="padding: 5px 10px !important;" type="button" class="btn btn-pri pay discard-payroll"> Booking History
                                </button></a>
                                {% endif %}
                        </div>

                    </div>

                </div>
            </div>
        </div>
        <div class="row pay-main">

            <input type="hidden" name="id" value="{{data.id}}">
        
            <div class="col-md-3 mb-3">
                <label for="fruit">Property Name</label>
                <div class="controls">
                 <input type="text" id="basiInput1" disabled name="Name" value="{{data.Name}}" class="form-control mystyle">

                </div>
            </div>
            <div class="col-md-12">
                <div class="row">
                    <div  class="col-md-2 br-right d-flex align-items-center">
                        <h6>Unit No</h6>
                    </div>
                    <div class="col-md-4">
                     <input type="text" id="basiInput2" disabled name="UnitNo" value="{{data.UnitNo}}" class="form-control mystyle">

                     </div>
                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>Phone No </h6>
                    </div>
                    <div class="col-md-4">
                        <input name="Phoneno"  disabled value="{%if data.Phoneno == None %}{% else %}{{data.Phoneno}}{% endif %}" type="text" class="form-control mystyle" id="basiInput31">
                    </div>
                </div>
                <div class="row mt-2">
                   
                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>Block No </h6>
                    </div>
                    <div class="col-md-4">
                        <input name="BlockNo" id="basiInput3" disabled value="{{data.BlockNo}}" type="text" class="form-control mystyle">
                    </div>
                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>Unit Area</h6>
                    </div>
                    <div class="col-md-4">
                        <input name="UnitArea" id="basiInput4" disabled value="{{data.UnitArea}}" type="text" class="form-control mystyle">
                    </div>
                </div>
                <div class="row mt-2">
                    
                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>Land Area </h6>
                    </div>
                    <div class="col-md-4 d-flex align-items-center">
                        
                            <input name="LandArea" value="{{data.LandArea}}" id="basiInput5" disabled type="text" class="form-control mystyle" >
                        
                    </div>
                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>U. Type</h6>
                    </div>
                    <div class="col-md-4">
                        <input name="UType" type="text" id="basiInput6" disabled value="{% if data.UType == None %}{% else %}{{data.UType}}{% endif %}" class="form-control mystyle" >
                    </div>
                </div>
                <div class="row mt-2">
                   
                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>Price </h6>
                    </div>
                    <div class="col-md-4 d-flex align-items-center">
                        
                            <input name="Price" id="basiInput7" disabled value="{{data.Price}}" type="text" class="form-control mystyle">
                        
                    </div>

                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>Bank </h6>
                    </div>
                    <div class="col-md-4 d-flex align-items-center">
                        
                            <input name="Bank" id="basiInput8" disabled value="{{data.Bank}}" type="text" class="form-control mystyle">
                        
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>Currency </h6>
                    </div>
                    <div class="col-md-4 d-flex align-items-center">
                        
                        <input name="currency" id="basiInput9" disabled value="{{data.currency}}" type="text" class="form-control mystyle" >
                        
                    </div>
                    <div class="col-md-2 br-right d-flex align-items-center">
                        <h6>Status </h6>
                    </div>
                    <!-- <div class="col-md-4 d-flex align-items-center" id="input_div">

                        {% if data.current_status == "0" %}
                        <input name="current_status" value="Available" type="text" class="form-control mystyle" id="basiInput10" disabled>
                        {% elif data.current_status == "1" %}
                        <input name="current_status" value="Price Quotation" type="text" class="form-control mystyle" id="basiInput11" disabled>
                        {% elif data.current_status == "2" %}
                        <input name="current_status" value="Sold" type="text" class="form-control mystyle" id="basiInput12" disabled>
                        {% elif data.current_status == "3" %}
                        <input name="current_status" value="Cancelled" type="text" class="form-control mystyle" id="basiInput13" disabled>
                        {% endif %}
                    </div> -->

                    <div class="col-md-4 d-flex align-items-center" id="select_div" style="" >
<style>
    .select_box_clr{
        background-color:#8c95a126!important;
    }
    .select_box_clr1{
        background-color: #ffffff!important;
    }
</style>
                        <select id="select_box" disabled name="current_status" class="floatLabel form-select mystyle select_box_clr"
                        aria-placeholder="Employee">
                       
                        {% if data.current_status == "0" %}
                        <option value="0">Available</option>

                        {% elif data.current_status == "1" %}
                        <option value="1">Price Quotation</option>

                        {% elif data.current_status == "2" %}
                        <option value="2">Sold</option>
                        {% elif data.current_status == "3" %}
                        <option value="3">Cancelled</option>
                        {% endif %}
                       
                        {% if data.current_status == "0" %}

                        {% else %}
                        <option value="0">Available</option>
                        {% endif %}

                        {% if data.current_status == "1" %}

                        {% else %}
                        <option value="1">Price Quotation</option>
                        {% endif %}
                        {% if data.current_status == "2" %}

                        {% else %}
                        <option value="2">Sold</option>
                        {% endif %}
                        {% if data.current_status == "3" %}

                        {% else %}
                        <option value="3">Cancelled</option>
                        {% endif %}
                       
                    </select>
                    </div>

                  
                    <div class="col-md-12 d-flex align-items-center">
                        <div class="col-md-2 br-right d-flex align-items-center">
                            <h6>Attachment </h6>
                        </div>
                        <style>
                            #files0::-webkit-file-upload-button {
                                visibility: hidden;
                                user-select: none;
                            }
                            .dfffff::-webkit-file-upload-button {
                        visibility: hidden;
                        user-select: none;
                        }
                            .file-input1 {
                                display: none;
                                user-select: none;
                            }
                            #files0 {
                                display: none;
                            }
                            </style>
                        <div id="selected_image0" style="display: none ;" class="apendcompany" >
                          
                            <label for="files0">

                                <img height="23px" width="23px"

                                    style="margin-left:25px; cursor: pointer;width: 18%;
                                    height: 1%;"

                                    src="{% static 'file_select.png' %}">

                            </label>
                            

                            <input style="    margin-top: -39px;" class="file-input1" onchange="image_change(0)" data-count=0 id="files0"

                                name="attachment" type="file"

                                 />

                        </div>
   
                        
                        <span  id="add_button" onclick="add_multiple_file_btn()" style="font-size: 18px;
                        font-weight: bold;cursor: pointer;    font-size: 14px;
                        font-weight: bold;
                        cursor: pointer;
                        padding: 1px 9px;
                        background: #222222;
                        color: white;display: none ">+</sapn>
                          
                           <!-- {% if data.imageURL == '' %}

                           {% else %}
                            <a  target="_blank" href="{{data.imageURL}}" ><i style="color: black" class="fa fa-eye" aria-hidden="true"></i></a>

                            {% endif %} -->
                        
                    </div>

                    <div class="col-md-12 d-flex align-items-center mt-4">

                        {% if multiple_image_data %}
                        <table class="table" border="1">
                            <thead class="thead-dark">
                              <tr>
                               
                                <th scope="col">Type</th>
                                <th scope="col">File</th>
                                <th scope="col">Action</th>
                              </tr>
                            </thead>
                            <tbody>
                                {% for i in multiple_image_data %}
                              <tr>
                                <th scope="row">
                                    {{i.image_type}}
                                </th>
                                <td>

                                    <a style="    color: black;
                                    font-weight: bold;" target="_blank" href="./media/{{i.attached_file}}"><i class="fa fa-eye" aria-hidden="true"></i></a>
                                </td>
                                <td>

                                    <a style="    color: black;
                                    font-weight: bold;" href="delete_image_action?id={{i.id}}"><i class="fa fa-trash" aria-hidden="true"></i></a>
                                </td>
                              
                              </tr>

                              {% endfor %}
                              
                            </tbody>
                          </table>

                          {% endif %}
                          
                         
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br>
    <div class="container">

        <p>Log</p>

        <div class="row">


            <div class="col-md-12">

              
                    {% for i in history %}
                    <div class='project-column mt-2'>
                        <a style="text-decoration: none;color: black" href="booking_more_details?id={{i.id}}">
                        <div class="customer-bx">

                            <div class="cust-img" style="background-image: url('../media/{{i.user_id.atatchment}}');">

                            </div>

                            <div class="customer-content">
                                <h5>New Booking Received <i>({{i.dt}})</i> </h5>
                                <span class="d-flex"><h6>Name : </h6> {{i.user_id.name|title}}</span>
                                <span class="d-flex"><h6>Email : </h6> {{i.user_id.email|title}}</span>
                                <span class="d-flex"><h6>Property No : </h6> {{i.property_mapping_id.BlockNo}}{{i.property_mapping_id.UnitNo}}</span>
                                
                                <span class="badge badge-soft-success text-uppercase">{{i.user_id.user_type}}</span>
                                {% if i.read_status == 0 %}
                                <span class="cust-badge badge-success mb-1">New</span>
                                {% else %}
                                {% endif %}
                            </div>

                           

                        </div>
                        <table class="table table-bordered">
                            <thead>
                              <tr>
                            
                                <th scope="col">username</th>
                               
                                <th scope="col">change status</th>
                                <th scope="col">date</th>
                              </tr>
                            </thead>
                            <tbody>
                                {% for j in i.booking_log_id.all %}
                              <tr>
                                <th scope="row">{% if j.user_type == "administrator" %}
                                    {{j.user_type|title}} </h6>
                                    {% else %}

                                    {{j.auth_user.email|title}}

                                    {% endif %}</th>
                                <td>{{j.d_text}}<br>
                                
                                
                                    {{j.status_content}}</td>
                                <td>{{j.dt}}</td>
                             
                              </tr>
                              {% endfor %}
                           
                            </tbody>
                          </table>
                        </a>


                    </div>
            
                    {% endfor %}
               
                    
               
            </div>
        </div>


    </div>
    <br>
    <br>

</form>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
{% if messages %}
   <script>
    {% for message in messages %}
        message1 = "{{message}}"
        if(message1 == "error"){
            Swal.fire({
  icon: 'error',
  title: 'Oops...',
  text: "{{ message }}",
})

        }
        else{
            Swal.fire(
				  '',
				  '{{ message }}',
				  '{{message.tags}}'
				)
            }
    {% endfor %}
   </script>
{% endif %}

<script>
   
    function image_change(count){
       
        document.getElementById("files"+count).style.display = "block"
    }
    count = 1
    function add_multiple_file_btn(){
        $(".apendcompany").append(`   <label for="files`+count+`">
        <img height="23px" width="23px"
            style="margin-left:25px; cursor: pointer;width: 18%;
            height: 1%;"
            src="{% static 'file_select.png' %}">
        </label>
        <input class="dfffff" style="    margin-top: -39px;" class="file-input1" onchange="image_change(`+count+`)" data-count=0 id="files`+count+`"
        name="attachment" type="file"

        />`)
        count = count + 1
    }
</script>

<script>
    function Edit_function(){
        // alert("hy")
        // document.getElementById("update_id").style.display = "block";
        $("#update_id").removeClass("display_name");
        $("#select_box").removeClass("select_box_clr");
        $("#select_box").addClass("select_box_clr1")
        document.getElementById("select_box" ).disabled=false;
        document.getElementById("edit_id").style.display = "none";
        var element1 = document.getElementById("basiInput1");
        element1.classList.remove("mystyle");
        document.getElementById("basiInput1").disabled = false;

        document.getElementById("selected_image0").style.display = "block";
        document.getElementById("add_button").style.display = "block";

        var element2 = document.getElementById("basiInput2");
        element2.classList.remove("mystyle");
        document.getElementById("basiInput2").disabled = false;

        var element31 = document.getElementById("basiInput31");
        element31.classList.remove("mystyle");
        document.getElementById("basiInput31").disabled = false;

        var element3 = document.getElementById("basiInput3");
        element3.classList.remove("mystyle");
        document.getElementById("basiInput3").disabled = false;

        var element4 = document.getElementById("basiInput4");
        element4.classList.remove("mystyle");
        document.getElementById("basiInput4").disabled = false;

        var element5 = document.getElementById("basiInput5");
        element5.classList.remove("mystyle");
        document.getElementById("basiInput5").disabled = false;

        var element6 = document.getElementById("basiInput6");
        element6.classList.remove("mystyle");
        document.getElementById("basiInput6").disabled = false;

        var element7 = document.getElementById("basiInput7");
        element7.classList.remove("mystyle");
        document.getElementById("basiInput7").disabled = false;

        var element8 = document.getElementById("basiInput8");
        element8.classList.remove("mystyle");
        document.getElementById("basiInput8").disabled = false;

        var element9 = document.getElementById("basiInput9");
        element9.classList.remove("mystyle");
        document.getElementById("basiInput9").disabled = false;

        var element10 = document.getElementById("basiInput10");
        element10.classList.remove("mystyle");
        document.getElementById("basiInput10").disabled = false;

        var element11 = document.getElementById("basiInput11");
        element11.classList.remove("mystyle");
        document.getElementById("basiInput11").disabled = false;

        var element12 = document.getElementById("basiInput12");
        element12.classList.remove("mystyle");
        document.getElementById("basiInput12").disabled = false;

        var element13 = document.getElementById("basiInput13");
        element13.classList.remove("mystyle");
        document.getElementById("basiInput13").disabled = false;

    }
</script>
    {% endblock %}